import{g as D}from"./categories.service-32ccc348.js";import{_ as b,r,o as d,c as a,a as n,b as t,t as i,y as S,l as p,w as v,F as C,f as y,g as M,d as I,j as P}from"./index-4ca67c65.js";import{n as L}from"./not-logged-in.component-00c8f410.js";import{v as F}from"./account-direction-validator.service-2bc715ca.js";import{v as U}from"./account-data-validator.service-5f7597b3.js";import{a as j}from"./payment-data-validator.service-856d023c.js";const T={props:{product:{required:!0},categories:{required:!0}},methods:{changeAmount(e){this.$emit("setAmount",this.product,e)}},watch:{"product.amount"(e){e?e>this.product.stock&&(e=this.product.stock,this.changeAmount(e)):this.changeAmount(0)}}},A={class:"flex-row"},B={class:"flex-col margin-1-height margin-2-width"},N={class:"text text-0"},E={class:"text text-2"},q={class:"text-1"},R={class:"flex-row margin-1-height flex-align-center"};function V(e,o,c,k,s,l){const m=r("pv-image"),u=r("pv-button"),f=r("pv-input-number");return d(),a("div",A,[n(m,{class:"cart-product",src:`/images/product-images/${c.product.id}/${this.product.image[0]}`,onClick:o[0]||(o[0]=_=>this.$emit("product",c.product))},null,8,["src"]),t("div",B,[t("div",N,i(c.categories[c.product.category].subcategory[c.product.subcategory].franchise[c.product.franchise].name),1),t("div",E,i(c.product.name),1),t("div",q,"S/. "+i(c.product.price.toFixed(2)),1),t("div",R,[n(u,{icon:c.product.amount>1?"pi pi-minus":"pi pi-trash",severity:"secondary",rounded:"",outlined:"","aria-label":"Quit one",onClick:o[1]||(o[1]=_=>l.changeAmount(this.product.amount-1))},null,8,["icon"]),n(f,{"aria-label":"Product Amount",modelValue:c.product.amount,"onUpdate:modelValue":o[2]||(o[2]=_=>c.product.amount=_),class:"small-input"},null,8,["modelValue"]),n(u,{icon:"pi pi-plus",severity:"secondary",rounded:"",outlined:"","aria-label":"Add one",onClick:o[3]||(o[3]=_=>l.changeAmount(this.product.amount+1)),disabled:this.product.amount>=this.product.stock},null,8,["disabled"])])])])}const O=b(T,[["render",V]]);const Y={computed:{paymentMethods(){return S}},props:{userInfo:{required:!0}},data(){return{infoCompleted:{personal:!1,shipping:!1,payment:!1}}},methods:{validateUserInfoCompleted(){this.infoCompleted={personal:!1,shipping:!1,payment:!1};let e=this.userInfo.shipping;this.infoCompleted.personal=!U(this.userInfo),this.infoCompleted.shipping=!F(e.address,e.department,e.province,e.district),this.infoCompleted.payment=!j(this.userInfo)},buyCart(){this.$emit("buyCart")},backToCart(){this.$emit("back")}},created(){console.log(this.paymentMethods),this.validateUserInfoCompleted()}},H={id:"back"},Q=t("i",{class:"pi pi-chevron-left"},null,-1),z=t("div",{class:"text-6 align-center"},"CheckOut",-1),G={class:"flex-align-center main-checkout-container"},J={id:"user_info_area",class:"flex-col gap-3"},K=t("div",{class:"margin-0-height"},null,-1),W={id:"personal_info"},X=t("div",{class:"text-2"}," Informacion del Receptor ",-1),Z={class:"margin-0"},w={key:0},tt={class:"text"},et={class:"text"},ot={class:"text"},st={key:1},it=t("div",{class:"text"}," La información personal de su cuenta está incompleta ",-1),nt=[it],ct=t("i",{class:"pi pi-pencil"},null,-1),dt={id:"shipping_info"},at=t("div",{class:"text-2"}," Direccion de Envío ",-1),rt={class:"margin-0"},lt={key:0},ut={class:"text"},_t={class:"text"},ht={class:"text"},pt={class:"text"},mt={key:1},vt=t("div",{class:"text"}," La información de envío de su cuenta no está completa ",-1),ft=[vt],gt=t("i",{class:"pi pi-pencil"},null,-1),yt={id:"payment_info"},xt=t("div",{class:"text-2"}," Método de Pago ",-1),Ct={class:"margin-0"},bt={key:0},kt={class:"text"},It={key:1},Pt=t("div",{class:"text"}," La información de pago de su cuenta no está completa ",-1),$t=[Pt],Dt={id:"link"},St=t("i",{class:"pi pi-pencil"},null,-1),Mt=t("div",{class:"margin-0-height"},null,-1),Lt={id:"monetary_area"},Ft=t("div",{class:"text-3 align-center"},"Resumen del Carrito",-1),Ut={class:"margin-1-height"},jt={class:"flex-justify-content"},Tt=t("div",null," Subtotal: ",-1),At={class:"flex-justify-content"},Bt=t("div",null," Envio: ",-1),Nt={class:"flex-justify-content margin-1-height"},Et=t("div",null," Total: ",-1),qt={class:"align-center margin-1-height"},Rt={class:"align-center"},Vt=t("br",null,null,-1);function Ot(e,o,c,k,s,l){const m=r("router-link"),u=r("pv-divider"),f=r("pv-button"),_=r("pv-image"),g=r("pv-card");return d(),a(C,null,[t("div",H,[t("div",{onClick:o[0]||(o[0]=(...x)=>l.backToCart&&l.backToCart(...x))},[Q,p(" Volver ")])]),z,t("div",G,[t("div",J,[K,t("div",W,[X,t("div",Z,[s.infoCompleted.personal?(d(),a("div",w,[t("div",tt," Nombre: "+i(this.userInfo.personal.firstName+" "+this.userInfo.personal.lastName),1),t("div",et," Sexo: "+i(this.userInfo.personal.genre?"Masculino":"Femenino"),1),t("div",ot," Telefono: "+i(this.userInfo.personal.phone),1)])):(d(),a("div",st,nt)),t("div",null,[n(m,{to:"/edit/personal",id:"link"},{default:v(()=>[ct,p(" Modificar Información Personal ")]),_:1})])])]),t("div",dt,[at,t("div",rt,[s.infoCompleted.shipping?(d(),a("div",lt,[t("div",ut," Dirección: "+i(this.userInfo.shipping.address),1),t("div",_t," Distrito: "+i(this.userInfo.shipping.district),1),t("div",ht," Provincia: "+i(this.userInfo.shipping.province),1),t("div",pt," Departamento: "+i(this.userInfo.shipping.department),1)])):(d(),a("div",mt,ft)),t("div",null,[n(m,{to:"/edit/directions",id:"link"},{default:v(()=>[gt,p(" Modificar Direccion de Envio ")]),_:1})])])]),t("div",yt,[xt,t("div",Ct,[s.infoCompleted.payment?(d(),a("div",bt,[t("div",kt,i(this.userInfo.payment.paymentMethod)+": "+i(this.userInfo.payment.selectedMethod===this.paymentMethods.Tarjeta?this.userInfo.payment.MethodData.name.slice(0,4)+" **** **** "+this.userInfo.payment.MethodData.name.slice(12,16):this.userInfo.payment.MethodData.name),1)])):(d(),a("div",It,$t)),t("div",Dt,[n(m,{to:"/edit/payment",id:"link"},{default:v(()=>[St,p(" Modificar Información de Pago ")]),_:1})])])]),Mt]),t("div",Lt,[n(g,{class:"colored-data-card"},{content:v(()=>[Ft,t("div",null,[n(u)]),t("div",Ut,[t("div",jt,[Tt,t("div",null," S/. "+i(c.userInfo.shop.cartPaymentData.subtotal.toFixed(2)),1)]),t("div",At,[Bt,t("div",null," S/. "+i(c.userInfo.shop.cartPaymentData.delivery.toFixed(2)),1)])]),t("div",Nt,[Et,t("div",null," S/. "+i(c.userInfo.shop.cartPaymentData.total.toFixed(2)),1)]),t("div",qt,[n(f,{severity:"secondary",label:"Comprar",rounded:"",onClick:l.buyCart,disabled:!s.infoCompleted.payment||!s.infoCompleted.personal||!s.infoCompleted.shipping},null,8,["onClick","disabled"])]),t("div",Rt,[n(_,{src:"public/images/logos/methods_cart.png",class:"payment-methods"}),Vt,p(" ¡Y otras formas de pago más! ")])]),_:1})])])],64)}const Yt=b(Y,[["render",Ot]]);const Ht={components:{productCartComponent:O,notLoggedInComponent:L,checkoutComponent:Yt},data(){return{userInfo:null,isUserLogged:!1,products:[],categories:[],subtotal:0,delivery:0}},methods:{goToProductPage(e){this.$emit("product",e)},getUserInfo(e){e!=null&&e?(this.userInfo=e,this.isUserLogged||(this.isUserLogged=!0)):this.isUserLogged&&(this.isUserLogged=!1)},setProductAmount(e,o){if(this.userInfo.shop.cart)if(o>0){let c=this.products.indexOf(e);this.products[c].stock<o&&(o=this.products[c].stock),this.userInfo.shop.cart[e.id].amount=o,this.products[c].amount=o}else delete this.userInfo.shop.cart[e.id],this.products.splice(this.products.indexOf(e),1);else console.log("Ha ocurrido un error");this.calcSubtotal(),y.methods.updateCartInformation(this.userInfo)},getProductsInCart(){if(this.isUserLogged)for(let e in this.userInfo.shop.cart)this.userInfo.shop.cart[e].amount!==0&&M(e).then(o=>{this.products.push(o),this.products[this.products.length-1].amount=this.userInfo.shop.cart[e].amount,this.calcSubtotal()})},calcSubtotal(){this.subtotal=0,this.delivery=0;for(let e in this.products)e=this.products[e],this.subtotal+=e.amount*e.price,this.delivery+=Math.sqrt(e.amount*e.price)*2},checkout(){this.calcSubtotal();let e=this.userInfo;e.shop.cartPaymentData={subtotal:this.subtotal,delivery:this.delivery,total:this.subtotal+this.delivery},y.methods.updateCheckoutInformation(e)},buyCart(){y.methods.buyUserCart(this.userInfo).then(e=>{this.$emit("orders")})}},created(){D().then(e=>{this.categories=e}),this.userInfo=y.methods.watchUser(this.getUserInfo),this.isUserLogged=!!this.userInfo,this.getProductsInCart()}},Qt={key:0},zt={key:0},Gt=t("div",{class:"text-6 align-center"},"Carrito",-1),Jt={class:"flex-align-center main-cart-container"},Kt={id:"products_area",class:"flex-col"},Wt=t("div",{class:"text-3 margin-1-height"},"Lista de Productos:",-1),Xt={key:0},Zt={key:1},wt=t("div",null," No has agregado productos al carrito ",-1),te=t("div",{class:"margin-1-height"},null,-1),ee=[wt,te],oe={id:"monetary_area"},se={key:0},ie=t("div",{class:"text-3 align-center"},"Resumen del Carrito",-1),ne={class:"flex-col gap-1"},ce={class:"flex-justify-content"},de=t("div",null," Precio unitario: ",-1),ae={class:"flex-justify-content"},re=t("div",null," Precio total: ",-1),le={class:"margin-1-height"},ue={class:"flex-justify-content"},_e=t("div",null," Subtotal: ",-1),he={class:"flex-justify-content"},pe=t("div",null," Envio: ",-1),me={class:"flex-justify-content margin-1-height"},ve=t("div",null," Total: ",-1),fe={class:"align-center margin-1-height"},ge={class:"align-center"},ye=t("br",null,null,-1),xe={key:1},Ce=t("div",{class:"text-3 align-center"},"Resumen del Carrito",-1),be=t("div",{class:"align-center"}," No hay artículos en el carrito ",-1),ke={class:"align-center"},Ie=t("br",null,null,-1),Pe=t("br",null,null,-1);function $e(e,o,c,k,s,l){const m=r("productCartComponent"),u=r("pv-divider"),f=r("pv-button"),_=r("pv-image"),g=r("pv-card"),x=r("checkout-component"),$=r("not-logged-in-component");return s.isUserLogged?(d(),a("div",Qt,[this.userInfo.shop.cartPaymentData?(d(),P(x,{key:1,"user-info":s.userInfo,onBack:o[0]||(o[0]=h=>s.userInfo.shop.cartPaymentData=null),onBuyCart:l.buyCart},null,8,["user-info","onBuyCart"])):(d(),a("div",zt,[Gt,p(" "+i(this.userInfo.shop.cartPaymentData)+" ",1),t("div",Jt,[t("div",Kt,[Wt,s.products&&s.products.length>0?(d(),a("div",Xt,[(d(!0),a(C,null,I(s.products,h=>(d(),a("div",{key:h},[n(m,{product:h,categories:s.categories,onSetAmount:l.setProductAmount,onProduct:l.goToProductPage},null,8,["product","categories","onSetAmount","onProduct"])]))),128))])):(d(),a("div",Zt,ee))]),t("div",oe,[s.products&&s.products.length>0?(d(),a("div",se,[n(g,{class:"colored-data-card"},{content:v(()=>[ie,t("div",null,[n(u)]),t("div",ne,[(d(!0),a(C,null,I(s.products,h=>(d(),a("div",{key:h},[t("div",null,i(h.name)+":",1),t("div",ce,[de,t("div",null," S/. "+i(h.price.toFixed(2)),1)]),t("div",ae,[re,t("div",null," S/. "+i((h.price*h.amount).toFixed(2)),1)])]))),128))]),t("div",null,[n(u)]),t("div",le,[t("div",ue,[_e,t("div",null," S/. "+i(s.subtotal.toFixed(2)),1)]),t("div",he,[pe,t("div",null," S/. "+i(s.delivery.toFixed(2)),1)])]),t("div",me,[ve,t("div",null," S/. "+i((s.subtotal+s.delivery).toFixed(2)),1)]),t("div",fe,[n(f,{severity:"secondary",label:"Ir a Checkout",rounded:"",onClick:l.checkout},null,8,["onClick"])]),t("div",ge,[n(_,{src:"public/images/logos/methods_cart.png",class:"payment-methods"}),ye,p(" ¡Y otras formas de pago más! ")])]),_:1})])):(d(),a("div",xe,[n(g,{class:"rounded_area"},{content:v(()=>[Ce,t("div",null,[n(u)]),be,t("div",null,[n(u)]),t("div",ke,[Ie,n(_,{src:"public/images/logos/methods_cart.png",class:"payment-methods"}),Pe,p(" ¡Y otras formas de pago más! ")])]),_:1})]))])])]))])):(d(),P($,{key:1}))}const je=b(Ht,[["render",$e]]);export{je as default};
